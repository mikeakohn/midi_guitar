/**
 *  GuitarStick
 *  Author: Michael Kohn
 *   Email: mike@mikekohn.net
 *     Web: https://www.mikekohn.net/
 * License: BSD
 *
 * Copyright 2024 by Michael Kohn
 *
 * https://www.mikekohn.net/micro/guitarstick.php
 *
 */

#ifndef NOTES_H
#define NOTES_H

#define MAX_FREQUENCY 2048

class Notes
{
public:
  Notes();
  ~Notes();

  const char *get_name(int frequency)
  {
    const char *name = frequency < MAX_FREQUENCY ? frequency_to_name[frequency] : NULL;

    return name == nullptr ? "-" : name;
  }

  int get_midi(int frequency)
  {
    if (frequency == 0) { return 0; }
    return frequency < MAX_FREQUENCY ? frequency_to_midi[frequency] : 0;
  }

private:
  struct Values
  {
    int frequency;
    int midi;
    const char *name;
  };

  const char **frequency_to_name;
  int *frequency_to_midi;

  Values values[109] =
  {
    { 16, 12, "C0" },
    { 17, 13, "C#0/Db0" },
    { 18, 14, "D0" },
    { 19, 15, "D#0/Eb0" },
    { 20, 16, "E0" },
    { 21, 17, "F0" },
    { 23, 18, "F#0/Gb0" },
    { 24, 19, "G0" },
    { 25, 20, "G#0/Ab0" },
    { 27, 21, "A0" },
    { 29, 22, "A#0/Bb0" },
    { 30, 23, "B0" },
    { 32, 24, "C1" },
    { 34, 25, "C#1/Db1" },
    { 36, 26, "D1" },
    { 38, 27, "D#1/Eb1" },
    { 41, 28, "E1" },
    { 43, 29, "F1" },
    { 46, 30, "F#1/Gb1" },
    { 49, 31, "G1" },
    { 51, 32, "G#1/Ab1" },
    { 55, 33, "A1" },
    { 58, 34, "A#1/Bb1" },
    { 61, 35, "B1" },
    { 65, 36, "C2" },
    { 69, 37, "C#2/Db2" },
    { 73, 38, "D2" },
    { 77, 39, "D#2/Eb2" },
    { 82, 40, "E2" },
    { 87, 41, "F2" },
    { 92, 42, "F#2/Gb2" },
    { 98, 43, "G2" },
    { 103, 44, "G#2/Ab2" },
    { 110, 45, "A2" },
    { 116, 46, "A#2/Bb2" },
    { 123, 47, "B2" },
    { 130, 48, "C3" },
    { 138, 49, "C#3/Db3" },
    { 146, 50, "D3" },
    { 155, 51, "D#3/Eb3" },
    { 164, 52, "E3" },
    { 174, 53, "F3" },
    { 185, 54, "F#3/Gb3" },
    { 196, 55, "G3" },
    { 207, 56, "G#3/Ab3" },
    { 220, 57, "A3" },
    { 233, 58, "A#3/Bb3" },
    { 246, 59, "B3" },
    { 261, 60, "C4" },
    { 277, 61, "C#4/Db4" },
    { 293, 62, "D4" },
    { 311, 63, "D#4/Eb4" },
    { 329, 64, "E4" },
    { 349, 65, "F4" },
    { 369, 66, "F#4/Gb4" },
    { 392, 67, "G4" },
    { 415, 68, "G#4/Ab4" },
    { 440, 69, "A4" },
    { 466, 70, "A#4/Bb4" },
    { 493, 71, "B4" },
    { 523, 72, "C5" },
    { 554, 73, "C#5/Db5" },
    { 587, 74, "D5" },
    { 622, 75, "D#5/Eb5" },
    { 659, 76, "E5" },
    { 698, 77, "F5" },
    { 739, 78, "F#5/Gb5" },
    { 783, 79, "G5" },
    { 830, 80, "G#5/Ab5" },
    { 880, 81, "A5" },
    { 932, 82, "A#5/Bb5" },
    { 987, 83, "B5" },
    { 1046, 84, "C6" },
    { 1108, 85, "C#6/Db6" },
    { 1174, 86, "D6" },
    { 1244, 87, "D#6/Eb6" },
    { 1318, 88, "E6" },
    { 1396, 89, "F6" },
    { 1479, 90, "F#6/Gb6" },
    { 1567, 91, "G6" },
    { 1661, 92, "G#6/Ab6" },
    { 1760, 93, "A6" },
    { 1864, 94, "A#6/Bb6" },
    { 1975, 95, "B6" },
    { 2093, 96, "C7" },
    { 2217, 97, "C#7/Db7" },
    { 2349, 98, "D7" },
    { 2489, 99, "D#7/Eb7" },
    { 2637, 100, "E7" },
    { 2793, 101, "F7" },
    { 2959, 102, "F#7/Gb7" },
    { 3135, 103, "G7" },
    { 3322, 104, "G#7/Ab7" },
    { 3520, 105, "A7" },
    { 3729, 106, "A#7/Bb7" },
    { 3951, 107, "B7" },
    { 4186, 108, "C8" },
    { 4434, 109, "C#8/Db8" },
    { 4698, 110, "D8" },
    { 4978, 111, "D#8/Eb8" },
    { 5274, 112, "E8" },
    { 5587, 113, "F8" },
    { 5919, 114, "F#8/Gb8" },
    { 6271, 115, "G8" },
    { 6644, 116, "G#8/Ab8" },
    { 7040, 117, "A8" },
    { 7458, 118, "A#8/Bb8" },
    { 7902, 119, "B8" },
    {    0,   0, NULL }
  };
};

#endif

